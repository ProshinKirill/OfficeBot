import random
import requests
import vk_api

def send_doc(event_peer_id, docx):
    """
    –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–æ—Ç–æ–≤—ã–π(—Å–æ–±—Ä–∞–Ω—ã–π) –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    :param event_peer_id: –ø–µ—Ä–µ–¥–∞—Ç—å id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—Å—è, –∫–æ—Ç–æ—Ä–æ–º—É –±—ã–ª —Å–¥–µ–ª–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç
    :param docx: –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    :return: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–æ—Ç–æ–≤—ã–π –¥–æ–∫–ª–∞–¥
    """

    # –î–æ–∫—É–º–µ–Ω—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–π –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
    openFile = open(docx, 'rb')

    # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≥—Ä—É–ø–ø—ã –≤ –í–∫–æ–Ω—Ç–∞–∫—Ç–µ —Å –ø–æ–º–æ—â—å—é —Ç–æ–∫–µ–Ω–∞
    token = "082f0cf6b4235f530b59eda2d166b89955861632ff559c6a16352f97625eab33402fe481f36fd453fcc22"
    vk_session = vk_api.VkApi(token=token)
    session_api = vk_session.get_api()

    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –º–µ—Å—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –í–∫–æ–Ω—Ç–∞–∫—Ç–µ
    uploadFile = vk_session.method("docs.getMessagesUploadServer", {"type": "doc", "peer_id": '{}'.format(event_peer_id)})['upload_url']

    # –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –í–∫–æ–Ω—Ç–∞–∫—Ç–µ
    requestsFile = requests.post(uploadFile, files={'file': openFile}).json()

    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –í–∫–æ–Ω—Ç–∞–∫—Ç–µ
    savefail = vk_session.method('docs.save', requestsFile)

    # –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –í–∫–æ–Ω—Ç–∞–∫—Ç–µ
    a = savefail['doc']['owner_id']
    b = savefail['doc']['id']

    # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—Ä–∞–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞(docx) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    session_api.messages.send(peer_id=event_peer_id,
                              message='''–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ç–≤–æ–π –¥–æ–∫–ª–∞–¥ –≤ —Ç–≤–æ–∏—Ö —Ä—É–∫–∞—Ö üòã

–ò –µ—â—ë! –ü—Ä–æ—Å—å–±–∞ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –æ —Ä–∞–±–æ—Ç–µ —Å –±–æ—Ç–æ–º, –∑–∞–º–µ—á–µ–Ω–Ω—ã—Ö –±–∞–≥–∞—Ö –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é üôè
üëâ–¢—É—Ç—å: https://vk.com/topic-189633572_40235641''',
                              random_id=random.randint(-2147483648, +2147483648),
                              attachment='doc{0}_{1}'.format(a, b))